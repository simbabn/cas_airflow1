from datetime import datetime
from airflow import DAG
import logging
from airflow.operators.python_operator import PythonOperator

def task1():
    print("Hello World")
    logging.info("Mon message de print")

def task2():
    tableau = [1, 2, 3, 4, 5]
    print("Données stockées dans le tableau :", tableau)

def task3():
    print("Good Bye World")
    # Utilisez ici le tableau créé dans la tâche précédente

with DAG( 

    dag_id='dag2',
    start_date=datetime(2023, 6, 13),
    description='affichage dans la console et création de tablea',
    schedule_interval="@daily",
    catchup = False
) as dag :
    
    task_1 = PythonOperator(
        task_id='task_1',
        python_callable=task1,
        dag=dag
    )

    task_2 = PythonOperator(
        task_id='task_2',
        python_callable=task2,
        dag=dag
    )

    task_3 = PythonOperator(
        task_id='task_3',
        python_callable=task3,
        dag=dag
    )

task_1 >> task_2 >> task_3
